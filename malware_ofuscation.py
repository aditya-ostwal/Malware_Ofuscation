import re
import pefile

# Open the executable file
pe = pefile.PE("malware.exe")

# Retrieve the section containing the code
code_section = None
for section in pe.sections:
    if section.Characteristics & 0x20 != 0:
        code_section = section
        break

if code_section is None:
    print("Code section not found")
    exit()

# Retrieve the code in the section
code = code_section.get_data()

# Check for common obfuscation patterns
if re.search(r'(?:(?:\\x[0-9A-Fa-f]{2}){4,})', code):
    print("Obfuscated code detected")

if re.search(r'(?:(?:\\x[0-9A-Fa-f]{2}){2,})', code):
    print("Potentially obfuscated code detected")

if re.search(r'((?<![a-zA-Z0-9])(?P<c>0x[0-9A-Fa-f]+)(?![a-zA-Z0-9]))', code):
    print("Hex-encoded values detected")

if re.search(r'((?<![a-zA-Z0-9])(?P<c>[01]{8})(?![a-zA-Z0-9]))', code):
    print("Binary-encoded values detected")
